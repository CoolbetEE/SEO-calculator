<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SEO Revenue Calculator</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');

    *, *::before, *::after {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', system-ui, -apple-system, sans-serif;
      background: linear-gradient(135deg, #e0e7ff 0%, #f3f4f6 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
      transition: background 0.3s;
    }

    .container {
      max-width: 1200px;
      width: 100%;
      margin: 40px auto;
      padding: 24px;
      background: #ffffff;
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
      display: grid;
      gap: 24px;
    }

    .header {
      text-align: center;
    }

    .header img {
      max-width: 180px;
      margin-bottom: 16px;
    }

    h1 {
      font-size: 2rem;
      font-weight: 700;
      color: #1e3a8a;
      margin-bottom: 8px;
      transition: color 0.3s;
    }

    .header p {
      font-size: 0.9rem;
      color: #6b7280;
      font-weight: 500;
    }

    .header p span {
      color: #3b82f6;
      font-weight: 600;
    }

    .content {
      display: grid;
      grid-template-columns: 1fr 2fr;
      gap: 24px;
    }

    .input-box, .output-box {
      padding: 24px;
      border-radius: 12px;
      background: #f8fafc;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      transition: background 0.3s;
    }

    .input-box {
      background: linear-gradient(145deg, #f8fafc, #e2e8f0);
    }

    .output-box {
      background: #ffffff;
    }

    label {
      display: block;
      font-size: 0.9rem;
      font-weight: 600;
      color: #374151;
      margin-bottom: 8px;
      transition: color 0.3s;
    }

    input, select, button {
      width: 100%;
      padding: 12px;
      margin-bottom: 16px;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      font-size: 1rem;
      background: #ffffff;
      color: #111827;
      transition: all 0.2s;
    }

    input:focus, select:focus, button:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
    }

    button {
      background: #3b82f6;
      color: #ffffff;
      font-weight: 600;
      cursor: pointer;
      border: none;
    }

    button:hover {
      background: #2563eb;
    }

    button:active {
      transform: scale(0.98);
    }

    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 50px;
      height: 24px;
      margin-left: 12px;
      vertical-align: middle;
    }

    .toggle-switch input {
      display: none;
    }

    .slider {
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background: #d1d5db;
      border-radius: 24px;
      cursor: pointer;
      transition: background 0.3s;
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background: #ffffff;
      border-radius: 50%;
      transition: transform 0.3s;
    }

    input:checked + .slider {
      background: #3b82f6;
    }

    input:checked + .slider:before {
      transform: translateX(26px);
    }

    .result {
      margin-top: 16px;
      padding: 16px;
      border-radius: 8px;
      background: #f1f5f9;
      border: 1px solid #e5e7eb;
      text-align: left;
      font-size: 0.9rem;
    }

    .result p {
      margin-bottom: 12px;
    }

    .blue-text {
      color: #3b82f6;
      font-weight: 600;
    }

    #spinner {
      display: none;
      text-align: center;
      font-size: 1rem;
      color: #3b82f6;
      margin: 16px 0;
    }

    #export-buttons {
      display: flex;
      gap: 12px;
    }

    #export-buttons button {
      flex: 1;
    }

    #revenueChart {
      margin-top: 24px;
      background: #ffffff;
      border-radius: 12px;
      padding: 12px;
      border: 1px solid #e5e7eb;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    }

    #output, #revenueChart {
      display: none;
    }

    .flag {
      width: 24px;
      height: 16px;
      vertical-align: middle;
      margin-left: 8px;
    }

    .error {
      color: #dc2626;
      font-weight: 600;
      text-align: center;
    }

    /* Dark Mode */
    body.dark-mode {
      background: linear-gradient(135deg, #1f2937 0%, #111827 100%);
    }

    body.dark-mode .container {
      background: #1f2937;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
    }

    body.dark-mode h1 {
      color: #93c5fd;
    }

    body.dark-mode .input-box {
      background: linear-gradient(145deg, #374151, #1f2937);
    }

    body.dark-mode .output-box {
      background: #1e1e2e;
    }

    body.dark-mode label {
      color: #d1d5db;
    }

    body.dark-mode input,
    body.dark-mode select {
      background: #374151;
      color: #f3f4f6;
      border-color: #4b5563;
    }

    body.dark-mode button {
      background: #60a5fa;
    }

    body.dark-mode button:hover {
      background: #3b82f6;
    }

    body.dark-mode .result {
      background: #374151;
      border-color: #4b5563;
      color: #f3f4f6;
    }

    body.dark-mode #revenueChart {
      background: #1e1e2e;
      border-color: #4b5563;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .content {
        grid-template-columns: 1fr;
      }
      .container {
        margin: 16px;
        padding: 16px;
      }
    }

    @media print {
      body {
        background: #ffffff;
      }
      button, .toggle-switch, img[alt="Logo"] {
        display: none !important;
      }
      .container {
        box-shadow: none;
        margin: 0;
        padding: 10px;
        background: #ffffff;
      }
      #output, #revenueChart {
        display: block !important;
      }
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body onload="setFlag()">
  <div class="container">
    <div class="header">
      <img src="https://i.imgur.com/xpnQzsh.png" alt="Logo">
      <div style="display: flex; align-items: center; justify-content: center; gap: 12px;">
        <h1>SEO Revenue Calculator</h1>
        <label class="toggle-switch">
          <input type="checkbox" id="darkModeToggle" onchange="toggleDarkMode()" aria-label="Toggle dark mode">
          <span class="slider"></span>
        </label>
      </div>
      <p>by <span>Edvard Kingissepp</span></p>
    </div>

    <div class="content">
      <div class="input-box">
        <label for="keyword">Keyword</label>
        <input type="text" id="keyword" placeholder="üîç Enter keyword">

        <label for="volume">Monthly Search Volume</label>
        <input type="number" id="volume" placeholder="üìà Enter search volume" min="0">

        <label for="market">Select Market</label>
        <select id="market" onchange="setFlag()">
          <option value="FI">Finland</option>
          <option value="SE">Sweden</option>
          <option value="EE">Estonia</option>
          <option value="CA">Canada</option>
          <option value="CL">Chile</option>
          <option value="EC">Ecuador</option>
          <option value="IS">Iceland</option>
          <option value="MX">Mexico</option>
          <option value="NO">Norway</option>
          <option value="ONT">Ontario</option>
          <option value="PE">Peru</option>
        </select>
        <span id="flagDisplay"></span>

        <label for="valueType">Use NGR or Turnover</label>
        <select id="valueType">
          <option value="ngr">NGR</option>
          <option value="turnover">Turnover</option>
        </select>

        <button onclick="calculateRevenue()">Calculate</button>
        <div id="spinner">‚è≥ Calculating...</div>
        <div id="export-buttons">
          <button onclick="exportToCSV()">Export CSV</button>
          <button onclick="window.print()">Export PDF</button>
        </div>
      </div>

      <div class="output-box">
        <div id="output" class="result"></div>
        <canvas id="revenueChart"></canvas>
      </div>
    </div>
  </div>

  <script>
    const flags = {
      FI: "https://flagcdn.com/fi.svg", SE: "https://flagcdn.com/se.svg", EE: "https://flagcdn.com/ee.svg",
      CA: "https://flagcdn.com/ca.svg", CL: "https://flagcdn.com/cl.svg", EC: "https://flagcdn.com/ec.svg",
      IS: "https://flagcdn.com/is.svg", MX: "https://flagcdn.com/mx.svg", NO: "https://flagcdn.com/no.svg",
      ONT: "https://flagcdn.com/ca.svg", PE: "https://flagcdn.com/pe.svg"
    };

    const data = {
      FI: { ngr: 62.75, turnover: 1616.56, cr: 0.05 },
      SE: { ngr: 46.27, turnover: 1324.77, cr: 0.05 },
      EE: { ngr: 44.22, turnover: 1267.34, cr: 0.05 },
      CA: { ngr: 35.26, turnover: 2578.08, cr: 0.04 },
      CL: { ngr: 27.54, turnover: 531.64, cr: 0.03 },
      EC: { ngr: 16.62, turnover: 484.91, cr: 0.03 },
      IS: { ngr: 78.94, turnover: 1869.87, cr: 0.05 },
      MX: { ngr: 6.85, turnover: 497.3, cr: 0.03 },
      NO: { ngr: 117.41, turnover: 2757.3, cr: 0.05 },
      ONT: { ngr: 0, turnover: 1865.69, cr: 0.04 },
      PE: { ngr: 26.14, turnover: 443.48, cr: 0.03 }
    };

    const visibility = [
      { ctr: 0.30, label: "Position 1" },
      { ctr: 0.15, label: "Position 2" },
      { ctr: 0.10, label: "Position 3" },
      { ctr: 0.07, label: "Position 4" },
      { ctr: 0.05, label: "Position 5" },
      { ctr: 0.03, label: "Positions 6‚Äì10" }
    ];

    function setFlag() {
      const market = document.getElementById('market').value;
      document.getElementById('flagDisplay').innerHTML = `<img class="flag" src="${flags[market]}" alt="${market} flag">`;
    }

    function toggleDarkMode() {
      document.body.classList.toggle('dark-mode');
      updateChartColors();
    }

    function animateCounter(id, end) {
      let el = document.getElementById(id);
      let start = 0;
      const step = Math.ceil(end / 40);
      const interval = setInterval(() => {
        start += step;
        if (start >= end) {
          el.textContent = end.toLocaleString('en-US', { style: 'currency', currency: 'EUR', minimumFractionDigits: 0 });
          clearInterval(interval);
        } else {
          el.textContent = start.toLocaleString('en-US', { style: 'currency', currency: 'EUR', minimumFractionDigits: 0 });
        }
      }, 15);
    }

    function updateChartColors() {
      const isDarkMode = document.body.classList.contains('dark-mode');
      if (window.revenueChart) {
        window.revenueChart.data.datasets[0].backgroundColor = isDarkMode
          ? 'rgba(96, 165, 250, 0.6)'
          : 'rgba(59, 130, 246, 0.6)';
        window.revenueChart.update();
      }
    }

    function calculateRevenue() {
      const volume = parseFloat(document.getElementById('volume').value);
      const market = document.getElementById('market').value;
      const valueType = document.getElementById('valueType').value;

      if (isNaN(volume) || volume < 0) {
        document.getElementById('spinner').style.display = 'none';
        document.getElementById('output').innerHTML = '<p class="error fade-in">Please enter a valid search volume.</p>';
        document.getElementById('output').style.display = 'block';
        document.getElementById('revenueChart').style.display = 'none';
        return;
      }

      const { cr, ngr, turnover } = data[market];
      const aov = valueType === 'ngr' ? ngr : turnover;

      const output = document.getElementById('output');
      document.getElementById('spinner').style.display = 'block';
      output.innerHTML = '';

      const labels = [];
      const revenues = [];

      setTimeout(() => {
        let html = '';
        visibility.forEach(({ ctr, label }, index) => {
          const traffic = Math.round(volume * ctr);
          const conv = Math.round(traffic * cr);
          const rev = Math.round(conv * aov);
          labels.push(label);
          revenues.push(rev);
          html += `
            <p class="fade-in">
              <b>${(ctr * 100).toFixed(1)}% Visibility (${label})</b><br>
              Traffic: <span class="blue-text">${traffic.toLocaleString()}</span><br>
              Conversions: <span class="blue-text">${conv.toLocaleString()}</span><br>
              Estimated Revenue: <span id="rev-${index}" class="blue-text">0</span>
            </p>`;
        });
        document.getElementById('spinner').style.display = 'none';
        document.getElementById('output').style.display = 'block';
        document.getElementById('revenueChart').style.display = 'block';
        output.innerHTML = html;

        visibility.forEach(({ ctr }, index) => {
          const traffic = Math.round(volume * ctr);
          const conv = Math.round(traffic * cr);
          const rev = Math.round(conv * aov);
          animateCounter(`rev-${index}`, rev);
        });

        const isDarkMode = document.body.classList.contains('dark-mode');
        const ctx = document.getElementById('revenueChart').getContext('2d');
        if (window.revenueChart && typeof window.revenueChart.destroy === 'function') {
          window.revenueChart.destroy();
        }
        window.revenueChart = new Chart(ctx, {
          type: 'bar',
          data: {
            labels: labels,
            datasets: [{
              label: 'Estimated Revenue (‚Ç¨)',
              data: revenues,
              backgroundColor: isDarkMode ? 'rgba(96, 165, 250, 0.6)' : 'rgba(59, 130, 246, 0.6)',
              borderRadius: 8
            }]
          },
          options: {
            responsive: true,
            plugins: {
              legend: { display: false },
              tooltip: {
                backgroundColor: isDarkMode ? '#1e1e2e' : '#ffffff',
                titleColor: isDarkMode ? '#f3f4f6' : '#111827',
                bodyColor: isDarkMode ? '#f3f4f6' : '#111827',
                borderColor: isDarkMode ? '#4b5563' : '#d1d5db',
                borderWidth: 1
              }
            },
            scales: {
              y: {
                beginAtZero: true,
                ticks: {
                  color: isDarkMode ? '#d1d5db' : '#374151',
                  callback: value => value.toLocaleString('en-US', { style: 'currency', currency: 'EUR', minimumFractionDigits: 0 })
                },
                grid: {
                  color: isDarkMode ? '#4b5563' : '#e5e7eb'
                }
              },
              x: {
                ticks: {
                  color: isDarkMode ? '#d1d5db' : '#374151'
                },
                grid: {
                  display: false
                }
              }
            }
          }
        });
      }, 800);
    }

    function exportToCSV() {
      const volume = parseFloat(document.getElementById('volume').value);
      const market = document.getElementById('market').value;
      const valueType = document.getElementById('valueType').value;

      if (isNaN(volume) || volume < 0) {
        alert('Please calculate revenue first with a valid search volume.');
        return;
      }

      const { cr, ngr, turnover } = data[market];
      const aov = valueType === 'ngr' ? ngr : turnover;

      let csvContent = 'Position,Visibility (%),Traffic,Conversions,Estimated Revenue (‚Ç¨)\n';
      visibility.forEach(({ ctr, label }) => {
        const traffic = Math.round(volume * ctr);
        const conv = Math.round(traffic * cr);
        const rev = Math.round(conv * aov);
        csvContent += `"${label}",${(ctr * 100).toFixed(1)},${traffic},${conv},${rev}\n`;
      });

      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement('a');
      link.setAttribute('href', URL.createObjectURL(blob));
      link.setAttribute('download', `seo_revenue_${market}_${valueType}.csv`);
      link.style.display = 'none';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }
  </script>
</body>
</html>
